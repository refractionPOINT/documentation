{
  "slug": "adapter-types-mac-unified-logging",
  "title": "Mac Unified Logging",
  "category": "",
  "metadata": {
    "summary": "Deploy standalone adapter for macOS Unified Logs ingestion with service persistence and predicate filtering",
    "keywords": [
      "adapter",
      "macOS",
      "unified logs",
      "service",
      "launchd"
    ],
    "complexity": "intermediate",
    "primary_use_case": "Install persistent macOS log collection adapter as system service"
  },
  "extracted_apis": [
    {
      "type": "cli_command",
      "method": "DOWNLOAD",
      "path": "curl https://downloads.limacharlie.io/adapter/mac/64 -o /usr/local/bin/lc_adapter",
      "description": "Download macOS adapter binary"
    },
    {
      "type": "cli_command",
      "method": "RUN_ADAPTER",
      "path": "/usr/local/bin/lc_adapter mac_unified_logging client_options.identity.installation_key=$INSTALLATION_KEY client_options.identity.oid=$OID client_options.hostname=$SENSOR_NAME client_options.platform=json client_options.sensor_seed_key=$SENSOR_NAME predicate=eventMessage CONTAINS[c] \"corp.sap.privileges\"",
      "description": "Run macOS unified logging adapter with configuration parameters"
    },
    {
      "type": "cli_command",
      "method": "LOAD_SERVICE",
      "path": "launchctl load -w /Library/LaunchDaemons/io.limacharlie.adapter.macunifiedlogging.plist",
      "description": "Load adapter as persistent macOS service"
    },
    {
      "type": "config_parameter",
      "method": "SENSOR_TYPE",
      "path": "sensor_type: \"mac_unified_logging\"",
      "description": "Adapter sensor type configuration"
    },
    {
      "type": "config_parameter",
      "method": "PREDICATE",
      "path": "predicate: 'processImagePath endswith \"/usr/sbin/sshd\" OR subsystem == \"com.apple.security\"'",
      "description": "Filter MUL events using macOS predicates"
    }
  ],
  "cross_refs": [
    {
      "target_slug": "ingesting-macos-unified-logs",
      "relationship": "alternative",
      "description": "Alternative approach using EDR sensor exfil rules instead of standalone adapter deployment"
    }
  ]
}