{
  "slug": "query-with-cli",
  "title": "Query with CLI",
  "category": "",
  "metadata": {
    "summary": "Command-line interface for querying LimaCharlie data with context management and paged results",
    "keywords": [
      "CLI",
      "command-line",
      "Python SDK",
      "paged queries",
      "automation"
    ],
    "complexity": "intermediate",
    "primary_use_case": "Automating queries and investigations from the command line"
  },
  "extracted_apis": [
    {
      "type": "cli_command",
      "method": "limacharlie query",
      "path": "limacharlie query",
      "description": "Main CLI command for querying LimaCharlie data"
    },
    {
      "type": "cli_command",
      "method": "set_time",
      "path": "set_time -3h",
      "description": "Set the timeframe for queries using ParseDuration format"
    },
    {
      "type": "cli_command",
      "method": "set_sensors",
      "path": "set_sensors plat == windows",
      "description": "Set sensor selector for which sensors to query"
    },
    {
      "type": "cli_command",
      "method": "set_events",
      "path": "set_events NEW_PROCESS DNS_REQUEST",
      "description": "Set event types to query (space separated, supports tab completion)"
    },
    {
      "type": "cli_command",
      "method": "set_limit_event",
      "path": "set_limit_event",
      "description": "Set maximum number of events to scan during query"
    },
    {
      "type": "cli_command",
      "method": "set_output",
      "path": "set_output",
      "description": "Mirror queries and results to a file"
    },
    {
      "type": "cli_command",
      "method": "set_format",
      "path": "set_format json|table",
      "description": "Display results in json or table format"
    },
    {
      "type": "cli_command",
      "method": "stats",
      "path": "stats",
      "description": "Display total costs incurred from queries during session"
    },
    {
      "type": "cli_command",
      "method": "q",
      "path": "q event/DOMAIN_NAME contains 'google'",
      "description": "Run query in paged mode (returns initial subset, use 'n' for next page)"
    },
    {
      "type": "cli_command",
      "method": "n",
      "path": "n",
      "description": "Fetch next page of results in paged mode"
    },
    {
      "type": "cli_command",
      "method": "qa",
      "path": "qa event/DOMAIN_NAME contains 'google'",
      "description": "Query all data (non-paged mode, computes all results over entire timeline)"
    },
    {
      "type": "cli_command",
      "method": "dryrun",
      "path": "dryrun event/COMMAND_LINE contains 'powershell'",
      "description": "Simulate query execution and return approximate worst case cost"
    }
  ],
  "cross_refs": [
    {
      "target_slug": "lcql",
      "relationship": "related",
      "description": "Query language syntax used in CLI queries"
    },
    {
      "target_slug": "query-console-ui",
      "relationship": "alternative",
      "description": "Web-based alternative to CLI for querying"
    }
  ]
}