<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Detections Report - lc_demo</title>

    <!-- Chart.js for interactive visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <script>
        // Chart.js default configuration
        // Using LimaCharlie brand colors
        Chart.defaults.color = '#333';
        Chart.defaults.borderColor = '#e0e0e0';
        Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif';

        // Brand colors for consistent styling across all charts
        const brandColors = {
            primary: '#667eea',
            secondary: '#764ba2',
            accent: '#4F9EEE',
            success: '#28a745',
            warning: '#ffc107',
            danger: '#dc3545',
            info: '#17a2b8'
        };
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: white;
            margin: 0 0 10px 0;
            font-size: 2.5em;
        }

        .header p {
            opacity: 0.9;
            margin: 5px 0;
            font-size: 1.1em;
        }

        /* KPI Dashboard Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .kpi-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .kpi-card.status-good { border-left: 5px solid #28a745; }
        .kpi-card.status-warning { border-left: 5px solid #ffc107; }
        .kpi-card.status-danger { border-left: 5px solid #dc3545; }
        .kpi-card.status-info { border-left: 5px solid #667eea; }

        .kpi-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .kpi-value {
            font-size: 3em;
            font-weight: bold;
            color: #333;
            line-height: 1;
        }

        .kpi-subtext {
            font-size: 0.95em;
            color: #666;
            margin-top: 10px;
        }

        .kpi-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card h2 {
            margin: 0 0 20px 0;
            color: #333;
            border-bottom: 3px solid #dc3545;
            padding-bottom: 10px;
            font-size: 1.5em;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .chart-container canvas {
            max-height: 400px;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .three-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .severity-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .severity-critical {
            background: #dc3545;
            color: white;
        }

        .severity-high {
            background: #fd7e14;
            color: white;
        }

        .severity-medium {
            background: #ffc107;
            color: #333;
        }

        .severity-low {
            background: #17a2b8;
            color: white;
        }

        .footer {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        @media (max-width: 1024px) {
            .three-column {
                grid-template-columns: 1fr;
            }
        }

        /* Collapsible sections */
        details {
            margin: 15px 0;
        }

        details summary {
            cursor: pointer;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            font-weight: 600;
            color: #333;
            user-select: none;
            transition: background 0.2s;
        }

        details summary:hover {
            background: #e9ecef;
        }

        details[open] summary {
            background: #667eea;
            color: white;
            border-radius: 8px 8px 0 0;
        }

        details summary::marker {
            color: #667eea;
        }

        details[open] summary::marker {
            color: white;
        }

        details .collapsible-content {
            padding: 0;
            margin-top: 0;
            border: 1px solid #e0e0e0;
            border-top: none;
            border-radius: 0 0 8px 8px;
        }

        details .collapsible-content table {
            margin: 0;
        }

        .expand-hint {
            font-size: 0.85em;
            color: #667eea;
            font-weight: normal;
            margin-left: 10px;
        }

        details[open] .expand-hint {
            color: white;
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            .kpi-value {
                font-size: 2em;
            }
        }

        @media print {
            body {
                background: white;
            }
            .card {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üö® Security Detections Report</h1>
            <p><strong>lc_demo</strong></p>
            <p>Generated: 2025-11-18T05:57:48.401646+00:00</p>
            <p>Period: 2025-11-11 to 2025-11-18 (7 days)</p>
        </div>

        <!-- KPI Dashboard -->
        <div class="kpi-grid">
            <div class="kpi-card status-warning">
                <div class="kpi-icon">üîí</div>
                <div class="kpi-label">Total Detections</div>
                <div class="kpi-value">10000</div>
                <div class="kpi-subtext">1428.6 per day average</div>
            </div>

            <div class="kpi-card status-good">
                <div class="kpi-icon">‚ö†Ô∏è</div>
                <div class="kpi-label">High Severity</div>
                <div class="kpi-value">0</div>
                <div class="kpi-subtext">Requires attention</div>
            </div>

            <div class="kpi-card status-info">
                <div class="kpi-icon">üìä</div>
                <div class="kpi-label">Detection Categories</div>
                <div class="kpi-value">13</div>
                <div class="kpi-subtext">Unique types</div>
            </div>

            <div class="kpi-card status-info">
                <div class="kpi-icon">‚öôÔ∏è</div>
                <div class="kpi-label">Active Rules</div>
                <div class="kpi-value">150</div>
                <div class="kpi-subtext">Detection & Response</div>
            </div>
        </div>

        <!-- Detection Timeline -->
        <div class="card">
            <h2>üìà Detection Timeline</h2>
            <div class="chart-container">
                <canvas id="detectionTimelineChart"></canvas>
            </div>

            <script>
                // Chart: Detection Timeline - Line Chart
                // Shows detections over time to identify trends and spikes
                new Chart(document.getElementById('detectionTimelineChart'), {
                    type: 'line',
                    data: {
                        labels: ["2025-11-13", "2025-11-14", "2025-11-15", "2025-11-16", "2025-11-17"],
                        datasets: [{
                            label: 'Detections',
                            data: [553, 142, 6734, 223, 2348],
                            borderColor: brandColors.danger,
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBackgroundColor: brandColors.danger
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                callbacks: {
                                    label: function(context) {
                                        return 'Detections: ' + context.parsed.y.toLocaleString();
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Number of Detections',
                                    font: { size: 12, weight: 'bold' }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Date',
                                    font: { size: 12, weight: 'bold' }
                                }
                            }
                        }
                    }
                });
            </script>
        </div>

        <!-- Charts Row -->
        <div class="two-column">
            <!-- Detection Categories -->
            <div class="card">
                <h2>üìä Detections by Category</h2>
                <div class="chart-container">
                    <canvas id="categoryChart"></canvas>
                </div>

                <script>
                    // Chart: Detections by Category - Horizontal Bar Chart
                    // Shows distribution of detection types
                    new Chart(document.getElementById('categoryChart'), {
                        type: 'bar',
                        data: {
                            labels: ["spam", "alphamountain-category", "AlphaMountain Category Alert on demo-win-2016.c.lc-demo-infra.internal.", "proc-older-than-10s", "Windows Defender Settings Changed", "AlphaMountain Category Alert on desktop-14dh692.lan", "unique-google-domain", "Windows Defender History Deleted", "new-sensor-enrolled", "windows-defender-history-deleted"],
                            datasets: [{
                                label: 'Detections',
                                data: [6396, 1225, 1042, 730, 240, 182, 168, 6, 3, 3],
                                backgroundColor: 'rgba(220, 53, 69, 0.8)',
                                borderColor: brandColors.danger,
                                borderWidth: 2
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                    padding: 12,
                                    callbacks: {
                                        label: function(context) {
                                            return 'Count: ' + context.parsed.x.toLocaleString();
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Detections',
                                        font: { size: 12, weight: 'bold' }
                                    }
                                }
                            }
                        }
                    });
                </script>
            </div>

            <!-- Hourly Distribution -->
            <div class="card">
                <h2>üïê Hourly Distribution</h2>
                <div class="chart-container">
                    <canvas id="hourlyChart"></canvas>
                </div>

                <script>
                    // Chart: Hourly Distribution - Bar Chart
                    // Shows when detections occur during the day (useful for identifying attack patterns)
                    new Chart(document.getElementById('hourlyChart'), {
                        type: 'bar',
                        data: {
                            labels: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
                            datasets: [{
                                label: 'Detections',
                                data: [1020, 5419, 10, 5, 4, 53, 155, 187, 7, 5, 5, 17, 417, 537, 492, 558, 106, 468, 78, 86, 175, 17, 8, 171],
                                backgroundColor: 'rgba(102, 126, 234, 0.7)',
                                borderColor: brandColors.primary,
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                    padding: 12,
                                    callbacks: {
                                        label: function(context) {
                                            return 'Detections: ' + context.parsed.y.toLocaleString();
                                        },
                                        title: function(context) {
                                            return 'Hour: ' + context[0].label + ':00 UTC';
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Detections',
                                        font: { size: 12, weight: 'bold' }
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Hour of Day (UTC)',
                                        font: { size: 12, weight: 'bold' }
                                    }
                                }
                            }
                        }
                    });
                </script>
            </div>
        </div>

        <!-- Top Rules and Sensors -->
        <div class="two-column">
            <!-- Top Triggered Rules -->
            <div class="card">
                <h2>üéØ Top Triggered Rules</h2>
                <div class="chart-container">
                    <canvas id="topRulesChart"></canvas>
                </div>

                <script>
                    // Chart: Top Triggered Rules - Horizontal Bar Chart
                    // Shows which detection rules are firing most frequently
                    new Chart(document.getElementById('topRulesChart'), {
                        type: 'bar',
                        data: {
                            labels: ["general.spam", "general.alphamountain-test", "general.alphaMountain High Category Alert", "general.older-than", "general.test-goog-suppression", "general.Windows Defender Settings Changed", "general.ext-epp Windows Defender Settings Changed", "general.deployment-enroll", "general.windows-defender-history-deleted", "general.Windows Defender History Deleted"],
                            datasets: [{
                                label: 'Detections',
                                data: [6396, 1225, 1224, 730, 168, 120, 120, 3, 3, 3],
                                backgroundColor: 'rgba(253, 126, 20, 0.8)',
                                borderColor: brandColors.warning,
                                borderWidth: 2
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                    padding: 12,
                                    callbacks: {
                                        label: function(context) {
                                            return 'Detections: ' + context.parsed.x.toLocaleString();
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Detections',
                                        font: { size: 12, weight: 'bold' }
                                    }
                                }
                            }
                        }
                    });
                </script>
            </div>

            <!-- Top Hosts/Sensors -->
            <div class="card">
                <h2>üíª Top Hosts by Detection Count</h2>
                <div class="chart-container">
                    <canvas id="topSensorsChart"></canvas>
                </div>

                <script>
                    // Chart: Top Hosts - Horizontal Bar Chart
                    // Shows which hosts are generating the most detections (using hostnames for readability)
                    new Chart(document.getElementById('topSensorsChart'), {
                        type: 'bar',
                        data: {
                            labels: ["demo-win-2016", "desktop-14dh692.lan", "christophersair.lan", "lc-demo.io", "bender-dev"],
                            datasets: [{
                                label: 'Detections',
                                data: [8527, 867, 603, 2, 1],
                                backgroundColor: 'rgba(23, 162, 184, 0.8)',
                                borderColor: brandColors.info,
                                borderWidth: 2
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                    padding: 12,
                                    callbacks: {
                                        label: function(context) {
                                            return 'Detections: ' + context.parsed.x.toLocaleString();
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Detections',
                                        font: { size: 12, weight: 'bold' }
                                    }
                                }
                            }
                        }
                    });
                </script>
            </div>
        </div>

        <!-- Detection Velocity -->
        <div class="card">
            <h2>üìâ Detection Velocity (Trend Analysis)</h2>
            <p style="margin-bottom: 15px; color: #666;">Day-over-day change in detection volume</p>
            <div class="chart-container">
                <canvas id="velocityChart"></canvas>
            </div>

            <script>
                // Chart: Detection Velocity - Line Chart
                // Shows the rate of change in detections (helps identify escalating threats)
                new Chart(document.getElementById('velocityChart'), {
                    type: 'line',
                    data: {
                        labels: ["2025-11-14", "2025-11-15", "2025-11-16", "2025-11-17"],
                        datasets: [
                            {
                                label: 'Detection Count',
                                data: [142, 6734, 223, 2348],
                                borderColor: brandColors.primary,
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Day-over-Day Change (%)',
                                data: [-74.3, 4642.3, -96.7, 952.9],
                                borderColor: brandColors.warning,
                                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                                borderWidth: 2,
                                fill: false,
                                tension: 0.4,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12
                            }
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Detection Count',
                                    font: { size: 12, weight: 'bold' }
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Percent Change (%)',
                                    font: { size: 12, weight: 'bold' }
                                },
                                grid: {
                                    drawOnChartArea: false
                                }
                            }
                        }
                    }
                });
            </script>
        </div>


        <div class="footer">
            <p>Generated by LimaCharlie Reporting Framework</p>
            <p style="font-size: 0.85em; color: #999; margin-top: 5px;">Organization ID: 8cbe27f4-bfa1-4afb-ba19-138cd51389cd</p>
        </div>
    </div>
</body>
</html>