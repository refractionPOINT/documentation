<!--
  _____   ____   _____ _    _ __  __ ______ _   _ _______ ____    __   ___  
 |  __ \ / __ \ / ____| |  | |  \/  |  ____| \ | |__   __|___ \  / /  / _ \ 
 | |  | | |  | | |    | |  | | \  / | |__  |  \| |  | |    __) |/ /_ | | | |
 | |  | | |  | | |    | |  | | |\/| |  __| | . ` |  | |   |__ <| '_ \| | | |
 | |__| | |__| | |____| |__| | |  | | |____| |\  |  | |   ___) | (_) | |_| |
 |_____/ \____/ \_____|\____/|_|  |_|______|_| \_|  |_|  |____/ \___/ \___/ 
                                                                            
 This site is powered by Document360 (https://www.document360.com), a self-service knowledge base platform.
--><!DOCTYPE html><html lang=en><head><!-- Primary Meta Tags --><meta name=title content="LimaCharlie Documentation | Writing and Testing Rules"><meta name=description><meta http-equiv=X-UA-Compatible content="IE=edge"><!-- Open Graph / Facebook --><meta property=og:type content=article><meta property=og:url><meta property=og:title content="LimaCharlie Documentation | Writing and Testing Rules"><meta property=og:description><meta property=og:image><!-- Twitter --><meta property=twitter:card content=summary_large_image><meta property=twitter:url><meta property=twitter:description><meta property=twitter:image><meta name=viewport content="width=device-width,initial-scale=1"><meta name=HandheldFriendly content=True><meta name=keywords content="detection and response,tutorial"><link rel=canonical href=https://docs.limacharlie.io/docs/writing-and-testing-rules><meta name=twitter:url content=https://docs.limacharlie.io/docs/writing-and-testing-rules><meta charset=utf-8><title>LimaCharlie Documentation | Writing and Testing Rules</title><meta name=twitter:title content="LimaCharlie Documentation | Writing and Testing Rules"><link rel=icon href=https://cdn.document360.io/84ec2311-0e05-4c58-90b9-baa9c041d22b/Images/Documentation/favicon.png type=image/x-icon><link href=https://cdn.document360.io/static/css/brands.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/duotone.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/fontawesome.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/light.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/regular.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/sharp-light.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/sharp-regular.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/sharp-solid.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/solid.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/thin.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/v4-font-face.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/v4-shims.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/v5-font-face.min.css rel=preload as=style><link href=https://cdn.document360.io/static/css/brands.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/duotone.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/fontawesome.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/light.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/regular.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/sharp-light.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/sharp-regular.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/sharp-solid.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/solid.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/thin.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/v4-font-face.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/v4-shims.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/v5-font-face.min.css rel=stylesheet><link href=https://cdn.document360.io/static/css/custom-icons.min.css rel=stylesheet><link rel=preconnect href=https://fonts.googleapis.com crossorigin><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&amp;family=Nunito:wght@300;400;500;600;700&amp;family=Open+Sans:wght@400;600;700&amp;family=Red+Hat+Display:wght@700;900&amp;family=Roboto:wght@400;500;700&amp;family=Calibri:wght@300;400;500;600;700;900&amp;display=swap" crossorigin referrerpolicy=no-referrer><link rel=stylesheet href=https://cdn.document360.io/static/css/prism-lightbox.ca5133140ca6391c9712.css.gz><link href=https://cdn.document360.io/static/css/print.c214dc186da0e6fcc942.css.gz media=print rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css><link rel=preload as=style href=https://cdn.document360.io/static/css/fluidTheme.de72d36550754aa3085f.css.gz><link rel=stylesheet href=https://cdn.document360.io/static/css/fluidTheme.de72d36550754aa3085f.css.gz><style>a{color:#00030c}a:hover{color:#2778c6}.main_content_block .default a{color:#2778c6}.main_content_block .default a:hover{color:#5adef9}.main_content_block .default a:visited{color:#2778c6}.main_content_block .default a:visited:hover{color:#5adef9;}.contributor-article-details ul li a{color:#2778c6}.contributor-article-details ul li a:hover{color:#5adef9}.contributor-article-details ul li a:visited{color:#2778c6}.contributor-article-details ul li a:visited:hover{color:#5adef9}.content_block .content_container .content_block_text a{color:#2778c6}.content_block .content_container .content_block_text a:hover{color:#5adef9}.content_block .content_container .content_block_text a:visited{color:#2778c6}.content_block .content_container .content_block_text a:visited:hover{color:#5adef9}.stickytop .sticky-details .share-details .share-buttons .jssocials-share a{color:#00030c}header .header_top .user-dropdown-content .user-detail .user-logout a,.slicknav_menu .slicknav_nav .header_top_nav_options .user-dropdown .user-dropdown-content .user-detail .user-dropdown-link-logout .user-logout a{background:#00030c;border-color:#00030c}header .header_top .user-dropdown-content .user-detail .user-logout a:hover{background:#2778c6;border-color:#2778c6}.changePasswordFormContainer .cp-inner .btn-primary,.changeEmailFormContainer .cp-inner .btn-primary{display:inline-block;background:#00030c}.changePasswordFormContainer .cp-inner .btn-primary:hover,.changeEmailFormContainer .cp-inner .btn-primary:hover{background:#2778c6}header .header_bottom{background:#00030c}header .header_bottom .header_bottom_nav ul li a:hover{background:#2778c6}header .header_bottom .header_bottom_nav ul li.versions-selection .version-dropdown ul li a:hover{background:#00030c}header .header-dropdown-selection .header-dropdown ul li a:hover{background:#00030c}footer .footer_social ul li a{background:#00030c}footer .footer_social ul li a:hover{background:#2778c6}.help_box .btn_primary{background:#00030c}.help_box .btn_primary:hover{background:#2778c6}.left_sidebar .left_sidebar_nav ul li a.active{background:#00030c}.landing_top .search-sec .search-icon-btn{color:#00030c}.contributor-hero-section{background:#00030c}.contributor-article-pagination ul li.active{background:#00030c}.progress-container .progress-bar{background:#00030c}.progress-container .progress-bar .progress-shadow{box-shadow:#00030c 0 0 10px}.search-results-container #hits .ais-Hits-list li .header_search_Results div{color:#00030c}.search-results-container #pagination .ais-Pagination-list li.ais-Pagination-item--selected a{background:#00030c}.contributor-top-head .top-header-l .versions-selection .version-dropdown ul li a:hover{background:#00030c}.left-sidebar-toggle .left-arrow:hover{color:#ffffff;background:#00030c !important;border-color:#00030c !important}.left-sidebar-toggle .right-arrow:hover{color:#ffffff;background:#00030c !important;border-color:#00030c !important}.left-sidebar-toggle:hover+.left_sidebar .left_sidebar_nav:after,.left-sidebar-toggle:hover+.left_sidebar .left_sidebar_nav:after{background:#00030c}#doc_feedback_collect .actions .btn.btn-primary{background:#00030c}.content_block .content_container .content_block_head .category-contributor-info .contributor-images .other-count{background-color:#00030c}.content_block .content_container .content_block_text .category-index-view .category-index-item .index-article-contributors .index-article-contributor-images .index-article-other-count{background-color:#00030c}.back-to-top{background-color:#00030c}div[data-snippet] .remove-callout,.code-language{display:none}.default .landing_widget .widget_block .widget_links li a{color:#2778c6}.default .landing_widget .widget_block .widget_links li a:hover{color:#5adef9}.default .landing_widget .widget_block .widget_links li a:visited{color:#2778c6}.default .landing_widget .widget_block .widget_links li a:visited:hover{color:#5adef9}.no-data .btn.btn-primary,.apidocs-no-data .btn.btn-primary{background-color:#00030c}body,.btn{font-family:Roboto}h1,h2,h3,h4,h5,h6{font-family:Arial}.contributor-top-head .top-header-l .title-text,.contributor-row .contributor-description .contributor-name,.stickytop .sticky-details .article-top-head .article-title,.content_block .content_container .content_block_text .category-index-view .category-index-item .category-index-title h2,.landing_top h1,.landing-category-section .category-title,.learn .support-center-section .support-center-title,.innovate .landing-category-section .category-title,.learn .landing-category-section .category-title{font-family:Arial}.contact-feedback-hero-section{background-color:#00030c}#contactus_feedback_collect_search .actions .btn.btn-primary{background:#00030c}.contactSearchButton{background:#00030c}.contact-feedback-container .contact-search-fedback .contact-search-fedback-actions .contact-search-fedback-r .btn.btn-primary{background-color:#00030c;border-color:#00030c}.generate_pdf_spinner{border:1px solid #00030c;border-right:0;border-top:0;border-color:#00030c !important}.generate_summary_spinner{border:1px solid #00030c;border-right:0;border-top:0;border-color:#00030c !important}.article-badge,.article-badge:hover{color:#00030c !important;background:transparent !important;transition:all 0.2s ease-in-out}.apidocs-article-badge,.apidocs-article-badge{color:#00030c !important;background:transparent !important;transition:all 0.2s ease-in-out}#pagination-demo li span{color:#00030c}#pagination-demo li.active span{background:#00030c}#pagination-demo li:first-child.active span,#pagination-demo li:last-child.active span{color:#00030c}body.dark_theme .previous-nav:hover,.previous-nav:hover{border-color:#00030c}body.dark_theme .previous-nav:hover .flex-col .previous-nav-link,.previous-nav:hover .flex-col .previous-nav-link{color:#00030c}body.dark_theme .next-nav:hover,.next-nav:hover{border-color:#00030c}body.dark_theme .next-nav:hover .flex-col .next-nav-link,.next-nav:hover .flex-col .next-nav-link{color:#00030c}.edit-profile .profile-container .col-full .user-image .fa-pencil{border:1px solid #00030c;color:#00030c}.edit-profile .profile-container .col-full .user-image .fa-pencil:hover{color:#fff;background-color:#00030c;transition:all 0.2s ease-in-out}.version-as-menu li a.active,#version-drop-down:hover,.version-drop-down-menu .version-as-menu li a:hover{background:#2778c6}header .header_bottom .header_bottom_nav.javascriptDisabled ul .version-as .version-as-menu{overflow:auto;scrollbar-color:#efefef transparent}header .header_bottom .header_bottom_nav.javascriptDisabled ul .version-as .version-as-menu::-webkit-scrollbar{background:#00030c;height:7px}header .header_bottom .header_bottom_nav.javascriptDisabled ul .version-as .version-as-menu::-webkit-scrollbar-thumb{background-color:#ccc;border-radius:10px}header .header_bottom .header_bottom_nav .v-menu-dropdown .version-as-menu li a:hover{background-color:#00030c}.version-as.v-menu-dropdown .version-as-menu li a.active{background-color:#00030c}header .header_bottom .header_bottom_nav ul li.versions-selection .version-dropdown ul li a.active{background-color:#00030c;color:#fff}.search-footer-bottom .popup-footer .action-buttons .btn-action{background-color:#00030c}.k-checkbox-wrapper .k-checkbox:checked:focus{box-shadow:0 0 3px 0 #00030c;border-color:#00030c}.k-checkbox-wrapper .k-checkbox:checked{color:#00030c}.k-checkbox-wrapper .k-checkbox:focus{box-shadow:none;border-color:#00030c}.popup-custom-checkbox .custom-control-input:checked+.custom-control-label:before{border-color:#00030c;background:#00030c}.updatedon-container .k-widget.k-button-group .k-button-solid-base{border-color:#00030c;color:#00030c;background-color:#fff}.updatedon-container .k-widget.k-button-group .k-button-solid-base.k-active,.updatedon-container .k-widget.k-button-group .k-button-solid-base.k-selected,.updatedon-container .k-widget.k-button-group .k-button-solid-base:active{border-color:#00030c;color:#fff;background-color:#00030c;box-shadow:none}.specific-date-btn .btn{color:#00030c}.k-animation-container .k-calendar-range td.k-range-end,.k-animation-container .k-calendar-range td.k-range-mid,.k-animation-container .k-calendar-range td.k-range-start{background-image:linear-gradient(transparent 1px,#00030c30 1px,#00030c30 calc(100% - 1px),transparent calc(100% - 1px))}.k-animation-container .k-calendar-range td.k-state-selected .k-link{border-color:#00030c;color:#fff;background-color:#00030c}.k-animation-container .k-calendar .k-today .k-link{color:#00030c;box-shadow:inset 0 0 0 1px #00030c}.k-animation-container .k-calendar-range .k-footer .k-nav-today{color:#00030c}.k-animation-container .k-calendar-td.k-state-selected.k-state-hover .k-link{background-color:#00030c !important}.k-animation-container .k-calendar-td.k-range-mid.k-state-hover .k-link{background-color:#00030c50 !important}.k-animation-container .k-calendar .k-calendar-header .k-nav-today:focus,.k-animation-container .k-calendar .k-calendar-header .k-nav-today:hover,.k-animation-container .k-calendar .k-footer .k-nav-today:focus,.k-animation-container .k-calendar .k-footer .k-nav-today:hover{color:#2778c6}.k-treeview-item .k-checkbox-wrapper .k-checkbox:checked{background:#00030c;border-color:#00030c}.k-treeview-item .k-checkbox-wrapper .k-checkbox.k-state-indeterminate,.k-treeview-item .k-checkbox-wrapper .k-checkbox:indeterminate{color:#00030c}.filter-search-popup .filter-input-box::placeholder{font-family:Roboto}.k-animation-container .k-checkbox.k-state-indeterminate::before,#category-treeview .k-checkbox:indeterminate::before{background-color:#00030c}#article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a div,#attachment-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a div,#apidocs-article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a div,{color:#2778c6}#article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:hover div,#attachment-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:hover div,#apidocs-article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:hover div,{color:#5adef9}#article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:visited div,#attachment-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:visited div,#apidocs-article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:visited div,{color:#2778c6}#article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:visited:hover div,#attachment-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:visited:hover div,#apidocs-article-hits .ais-Hits .ais-Hits-list .ais-Hits-item .header_search_Results a:visited:hover div,{color:#5adef9}.try-it-section-expand-container:hover,.tryit-footer .try-it-btn,.try-it-parameters-section .try-it-parameter-container-input input[type="file"]::file-selector-button{background-color:#00030c !important}.try-it-parameters-section .try-it-parameter-container-input input[type="file"]::file-selector-button:hover,.tryit-footer .try-it-btn:hover{background:#5adef9 !important}.try-it-section .sec-try-it .try-it-component .try-it-authentication .oauth-container .oauth-footer .auth-btn{background-color:#00030c}.try-it-section .sec-try-it .try-it-component .try-it-authentication .oauth-container .oauth-footer .auth-btn:hover{background-color:#5adef9}</style><style>.learn .landing_top .search-sec .ais-SearchBox-submit{background:#00030c}.engage .landing_widget .widget_block .widget_links li a,.learn .landing_widget .widget_block .widget_links li a,.innovate .landing_widget .widget_block .widget_links li a{color:#00030c}.engage .landing_widget .widget_block .widget_links li a:hover,.learn .landing_widget .widget_block .widget_links li a:hover,.innovate .landing_widget .widget_block .widget_links li a:hover{color:#2778c6}.learn .support-center-section .contact-us-section .contact-us-action a{background-color:#00030c;border:1px solid transparent}.learn .support-center-section .contact-us-section .contact-us-action a:hover{background-color:transparent;border:1px solid #00030c;color:#00030c}.engage .contact-us-section .contact-us-l .contact-us-icon,.engage .contact-us-section .contact-us-r .contact-us-icon{color:#00030c}.engage .landing_top a.header-link,.innovate .landing_top a.header-link,.learn .landing_top a.header-link{background:#00030c;border:#00030c 2px solid}.engage .landing_top a.header-link:hover,.innovate .landing_top a.header-link:hover,.learn .landing_top a.header-link:hover{color:#00030c;border:#00030c 2px solid;background:#fff}.engage .landing_widget .widget_block .widget_links li:hover::before{background-color:#00030c}</style><style>body{font-family:'Inter',sans-serif;font-family:'Syne',sans-serif}a{font-family:'Syne',sans-serif;text-transform:uppercase !important}.column-icon{color:#2778c6 !important}.category-icon{color:#2778c6 !important}.landing_top{background-image:url("https://images.ctfassets.net/8ypp714zy4gs/4XF83FQ0492lbrnaF3q7rP/3547d49ce4cebff920a3a47b487e4b24/bg-image.png") !important;height:500px !Important;background-position:center !Important;background-repeat:no-repeat !Important;background-size:cover !Important;background-color:rgba(0,0,0,1) !important}.header_top_nav_right a{color:#ffffff !important;background-color:#2778c6 !important;border-color:#2778c6 !important}.landing_top a{color:rgba(255,255,255,1) !important;background-color:#f02463 !important;border-color:#f02463 !important}.landing_top a:hover{color:rgba(255,255,255,1) !important;background-color:#ff487b !important;border-color:#ff487b !important}.search-sec a{background-color:rgba(255,255,255,1) !important}.search-sec a:hover{background-color:rgba(255,255,255,1) !important}.landing_top h1{color:#ffffff !important;font-family:'Syne',sans-serif !important}h1,h2,h3{font-family:'Syne',sans-serif;color:#123c78 !important}.landing_top em{color:#ffffff !important;background:#5adef9 !important}.landing_top p{color:#ffffff !important}.header_search_Results p{color:gray !important}p{font-family:'Inter',sans-serif}.category-title{color:#5adef9 !important}.fad{font-weight:100}.fad.fa-play:after{font-family:"Material Icons";content:"\e089"}.fa-play:before{font-family:"Material Icons";content:"\e089"}.fad.fa-plug:after{font-family:"Material Icons";content:"\f1b7"}.fa-plug:before{font-family:"Material Icons";content:"\f1b7"}.fad.fa-question:after{font-family:"Material Icons";content:"\f04c"}.fa-question:before{font-family:"Material Icons";content:"\f04c"}.grid-container{display:grid;grid-template-columns:repeat(3,1fr);grid-gap:20px;margin-left:40px;margin-right:40px;margin-bottom:100px}.landing-category-section{background:#00030c !important;padding:80px 40px 80px 40px !important}.landing-category-section:before{background:rgba(0,30,90,1) !important;position:absolute !important;height:100% !important;width:4000px !important;left:-2000px !important;z-index:-1 !important}.landing-category-section .col-block{background-color:rgba(255,255,255,1) !important;box-shadow:0 6px 48px 0 rgba(90,222,249,0.50) !important}.landing-category-section .col-block:hover{box-shadow:0 6px 48px 0 rgba(90,222,249,0.90) !important}.landing-category-section .category-title{color:rgba(255,255,255,1)}.landing-category-section p{color:rgba(51,51,51,1) !important}.fad.fa-cogs:after{font-family:"Material Icons";content:"\ea3d"}.fa-cogs:before{font-family:"Material Icons";content:"\ea3d"}.fad.fa-signal-stream:after{font-family:"Material Icons";content:"\e51e"}.fa-signal-stream:before{font-family:"Material Icons";content:"\e51e"}.fad.fa-sensor-alert:after{font-family:"Material Icons";content:"\e002"}.fa-sensor-alert:before{font-family:"Material Icons";content:"\e002"}.fad.fa-map-signs:after{font-family:"Material Icons";content:"\ebbe"}.fa-map-signs:before{font-family:"Material Icons";content:"\ebbe"}.fad.fa-sitemap:after{font-family:"Material Icons";content:"\eb2f"}.fa-sitemap:before{font-family:"Material Icons";content:"\eb2f"}.fad.fa-wrench:after{font-family:"Material Icons";content:"\e869"}.fa-wrench:before{font-family:"Material Icons";content:"\e869"}.fad.fa-arrow-circle-right:after{font-family:"Material Icons";content:"\e941"}.fa-arrow-circle-right:before{font-family:"Material Icons";content:"\e941"}.more-icon{color:#f02463 !important;background-color:rgba(105,161,206,0) !important;font-size:1.5rem !important}#center{text-align:center}div[data-snippet] table{display:block!important}</style><style>body{font-family:Roboto}</style><style>h1,h2,h3,h4,h5,h6{font-family:Arial}</style><style>.left_sidebar .left_sidebar_nav ul li a .Custom-batch{background-color:#8DBACF;color:#fff}.left_sidebar .left_sidebar_nav ul li a .bubble-custom{background-color:#8DBACF;color:#fff}</style><style></style><script nonce="">var layoutData={domainName:'document360.io',projectVersionId:'7cb73d60-7d39-4bc3-aaf4-6a94885ede5c',algoliaArticlesIndexId:'articles11',algoliaSearchKey:'MWM3NTkxYjc4NTFhNTMzYTNiNjM0M2U0NzBiYTRhNTA2YzFlNDM5YjIzNmIxZWFlNDA3MzMwNTFiYjhhNDYzOWZpbHRlcnM9cHJvamVjdElkJTNBODRlYzIzMTEtMGUwNS00YzU4LTkwYjktYmFhOWMwNDFkMjJiJTIwQU5EJTIwTk9UJTIwaXNEZWxldGVkJTNBdHJ1ZSUyMEFORCUyMGlzRHJhZnQlM0FmYWxzZSUyMEFORCUyMGV4Y2x1ZGUlM0FmYWxzZSUyMEFORCUyMGlzSGlkZGVuJTNBZmFsc2UlMjBBTkQlMjBOT1QlMjBpc0NhdGVnb3J5SGlkZGVuJTNBdHJ1ZSUyMEFORCUyME5PVCUyMGlzVW5wdWJsaXNoZWQlM0F0cnVlJTIwQU5EJTIwTk9UJTIwZmxvd0FydGljbGVUeXBlJTNBZmxvaWsmbWluV29yZFNpemVmb3IxVHlwbz01Jm1pbldvcmRTaXplZm9yMlR5cG9zPTgmYWR2YW5jZWRTeW50YXg9dHJ1ZSZzeW5vbnltcz10cnVlJnR5cG9Ub2xlcmFuY2U9dHJ1ZSZyZW1vdmVTdG9wV29yZHM9ZW4mcmVzdHJpY3RJbmRpY2VzPWFydGljbGVzMTEmdmFsaWRVbnRpbD0xNzYwNTUyMzQ0',algoliaSearchAttachmentsKey:'NDFlNWM3OGUzN2I2YTQyNjQzZjJjNDcxNzk5ZWE3NjYyMDVlZjA5MDY2MjQ4ZmI1YzVmOWI3MDc5ZDE5MjBmY2ZpbHRlcnM9cHJvamVjdElkJTNBODRlYzIzMTEtMGUwNS00YzU4LTkwYjktYmFhOWMwNDFkMjJiJm1pbldvcmRTaXplZm9yMVR5cG89NSZtaW5Xb3JkU2l6ZWZvcjJUeXBvcz04JmFkdmFuY2VkU3ludGF4PXRydWUmc3lub255bXM9dHJ1ZSZ0eXBvVG9sZXJhbmNlPXRydWUmcmVtb3ZlU3RvcFdvcmRzPWVuJnJlc3RyaWN0SW5kaWNlcz1tZWRpYUZpbGVzJnZhbGlkVW50aWw9MTc2MDU1MjM0NA==',algoliaSearchFilters:'projectId:84ec2311-0e05-4c58-90b9-baa9c041d22b AND languageId:5d3b0a53-aea6-4205-bac3-71d70c4d3313 AND NOT isDeleted:true AND isDraft:false AND exclude:false AND isHidden:false AND NOT isCategoryHidden:true AND NOT isUnpublished:true AND NOT flowArticleType:floik',algoliaAppId:'JX9O5RE9SU',projectId:'84ec2311-0e05-4c58-90b9-baa9c041d22b',versionSlug:'v2',mainVersion:'True'==='True',cdn:'https://cdn.document360.io/static',languageVersionId:'5d3b0a53-aea6-4205-bac3-71d70c4d3313',isDefaultLanguage:'True'==='True',langCode:'en',viewAllResults:'View All Results',userName:'',emailId:'',hideUserFeedbackNameEmail:'False'==='True',enableSearchHighlight:true,hostingPath:'docs',projectDomain:'docs.limacharlie.io',apiUrl:'https://api.document360.io',showAttachmentsTabInSearch:false,enableSearchAttachmentsFeature:false,articles:'Articles',attachments:'Attachments',isAdvancedSearchEnabled:true,isNoSearchResultFeedbackEnabled:true,analyticsDataCollectorUrl:'https://gateway.document360.io/analytics/api/collector',isSmartBarConfigured:'False'==='True',isAccountActivated:'True',activatedBy:'',activatedOn:'01/01/0001 00:00:00',gotoAdvancedSearch:'Go to advanced search',versionType:'KnowledgeBase',endpoint:'null',isLazyLoadingEnabled:'False'==='True',useBackendSearch:'False'==='True',backendSearchServerHost:'gateway.document360.io/search',isPreview:'False'==='True',previewId:'',isCategory:'False'==='True',versionNumber:'0',loggedInUserId:'',userType:'',toEnableAllVersionInAdvancedSearch:false,projectVersions:'[{"id":"6404f21a-81fe-40e2-8877-540cc0a4d68b","versionNumber":1,"baseVersionNumber":0,"baseVersionId":null,"versionCodeName":"v1","isMainVersion":false,"isBeta":false,"isPublic":true,"isDeprecated":true,"createdAt":"2022-11-27T18:14:06.972Z","modifiedAt":"2024-10-29T14:55:35.044Z","advanceOptions":null,"slug":"v1","languageVersions":[{"id":"92f6428d-eb84-4ee8-a510-2394b504df20","name":"English","code":"en","setAsDefault":true,"hidden":false,"enableRTL":false,"languageUrl":null,"siteProtectionLevel":0,"isInheritanceDisabled":false,"hasInheritanceDisabledCategoriesOrArticles":false,"countryFlagCode":"us","displayName":"English","isHomePageEnabled":false,"versionDisplayName":null}],"versionURI":null,"order":0,"siteProtectionLevel":0,"canModifyVersion":false,"changeVersionForInternalLink":false,"projectVersionType":0,"isInheritanceDisabled":false,"redirectionFrom":null,"isSetRedirect":false,"userId":null,"canShowInDocs":false,"canShowInGuides":false},{"id":"7cb73d60-7d39-4bc3-aaf4-6a94885ede5c","versionNumber":0,"baseVersionNumber":0,"baseVersionId":null,"versionCodeName":"v2","isMainVersion":true,"isBeta":false,"isPublic":true,"isDeprecated":false,"createdAt":"2024-10-02T17:11:05.006Z","modifiedAt":"2024-11-18T18:26:25.207Z","advanceOptions":null,"slug":"v2","languageVersions":[{"id":"5d3b0a53-aea6-4205-bac3-71d70c4d3313","name":"English","code":"en","setAsDefault":true,"hidden":false,"enableRTL":false,"languageUrl":"/docs/writing-and-testing-rules","siteProtectionLevel":0,"isInheritanceDisabled":false,"hasInheritanceDisabledCategoriesOrArticles":false,"countryFlagCode":"us","displayName":"English","isHomePageEnabled":false,"versionDisplayName":null}],"versionURI":null,"order":1,"siteProtectionLevel":0,"canModifyVersion":false,"changeVersionForInternalLink":false,"projectVersionType":0,"isInheritanceDisabled":false,"redirectionFrom":null,"isSetRedirect":false,"userId":null,"canShowInDocs":false,"canShowInGuides":false}]',isGlobalDashboard:'False'==='True',isThemeSelectionEnabled:'True'==='True',primaryColor:'#00030c',isAISearchEnabled:'False'==='True',isSupportUser:'False'==='True',algoliaSearchapidocsFilters:'',kbsitealgoliaSearchFilters:'',isStandardProject:false,apidocsArticles:'API Endpoints',isJwtUser:'False'==='True',sourceArticles:'Source articles',thanksForFeedback:'Thank you for your feedback!',feedbackNotSubmitted:'Failed to submit your feedback',summaryNotAvailableForTheArticle:'Summary not available for the article',isUserAclApplied:'False'==='True'};</script><!-- Load API documentation scripts before main.js, otherwise global functions like <onTagsChecked> are not accessible in advanced search which breaks the dropdown selection functionality --><script src=https://cdn.document360.io/static/js/vendor.4ae16f7f0d6e9cc9c74b.js.gz></script><script src=https://cdn.document360.io/static/js/datacollector.77cb06f4a57f2906ef29.js.gz></script><script src=https://cdn.document360.io/static/js/main.54b1b94a4ab2699d4e97.js.gz></script><!-- Custom HTML Tag --><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Rubik&amp;family=Spline+Sans+Mono:wght@300;400;700&amp;display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&amp;family=Syne:wght@400;500;600;700;800&amp;display=swap" rel=stylesheet><meta property=og:image content=https://images.ctfassets.net/8ypp714zy4gs/4mbAyitprLa7PvIf2WIIHA/16ee809217acd1423d56e10d9e2bdf5a/limacharlie-min.png><meta property=og:image:secure_url content=https://images.ctfassets.net/8ypp714zy4gs/4mbAyitprLa7PvIf2WIIHA/16ee809217acd1423d56e10d9e2bdf5a/limacharlie-min.png><link rel=stylesheet href=https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css><script src=https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js></script><df-messenger project-id=lc-sales agent-id=845bf4df-5e0e-4bc0-84fd-d1ecf138a57e language-code=en max-query-length=-1> <df-messenger-chat-bubble chat-title="Chuck the support bot"> </df-messenger-chat-bubble> </df-messenger><style>df-messenger{z-index:999;position:fixed;--df-messenger-font-color:#000;--df-messenger-font-family:Google Sans;--df-messenger-chat-background:#f3f6fc;--df-messenger-message-user-background:#d3e3fd;--df-messenger-message-bot-background:#fff;bottom:16px;right:16px}</style><!-- Google Tag Manager --><script nonce={{Document360-Nonce}}>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-TJRD9PG');</script><!-- End Google Tag Manager --></head><body><div class=mobile_header_logo></div><div class=search_overlay></div><header id=doc_header><div class=header_top><div class=container><a href="/" class=header_logo> <img src=https://cdn.document360.io/logo/84ec2311-0e05-4c58-90b9-baa9c041d22b/a8f5c28d58ea4df0b59badd4cebcc541-Logo_Blue.png alt=LimaCharlie> </a><div class=header_top_nav><div class=header_top_nav_left><ul></ul></div><div class=header_top_nav_right><ul><li><a href=https://app.limacharlie.io style=background:#4277a4;color:#ffffff class=action-item>LimaCharlie Log In</a></li></ul></div><div class=header_top_nav_options></div></div><div class=clearfix></div></div></div><div id=smartBarContainer1></div><div class=header_bottom><div class=container><div class="header_bottom_nav javascriptDisabled"><ul><li><a href=/v2/en class=home-icon><i class="fal fa-home"></i></a></li><!-- version dropdown --><li class=versions-selection><div class=version-select><span class=v-name title=v2>v2</span></div><div class=version-dropdown><ul><li><a href=/v1/docs title=v1> <span class=v-name>v1</span> <span class="v-status deprecated">Deprecated</span> </a></li><li><a class=active href=/docs title=v2> <span class=v-name>v2</span> </a></li></ul></div></li><!-- version as menu --> <!-- langauge dropdown --><li class=whats-new-icon><a href=/docs/en/whats-newx class=whats-new-icon><span title="What's New"><i class="fal fa-gift"></i></span></a></li></ul><div class=header_search><div class=header_search_box id=header_search_box><div class="aa-input-container search-form" id=aa-input-container><div name=searchform id=Searchform><input type=search id=aa-search-input class=aa-input-search placeholder=Search name=search autocomplete=off> <a class=ais-SearchBox-submit id=all_search_results href=#> <svg xmlns=http://www.w3.org/2000/svg width=10 height=10 viewBox="0 0 40 40"><path d="M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z"></path></svg> </a> <button class=ais-SearchBox-reset style=display:none id=cancel-search-input> <svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 20 20" width=10 height=10><path d="M8.114 10L.944 2.83 0 1.885 1.886 0l.943.943L10 8.113l7.17-7.17.944-.943L20 1.886l-.943.943-7.17 7.17 7.17 7.17.943.944L18.114 20l-.943-.943-7.17-7.17-7.17 7.17-.944.943L0 18.114l.943-.943L8.113 10z"></path></svg> </button> <span class=ais-SearchBox-loadingIndicator style=display:none id=search-input-loading> <svg width=16 height=16 viewBox="0 0 38 38" xmlns=http://www.w3.org/2000/svg stroke=#444><g fill=none fillrule=evenodd><g transform="translate(1 1)" strokewidth=2><circle strokeopacity=.5 cx=18 cy=18 r=18></circle><path d="M36 18c0-9.94-8.06-18-18-18" transform="rotate(3.02328 18 18)"><animateTransform attributeName=transform type=rotate from="0 18 18" to="360 18 18" dur=1s repeatCount=indefinite></animateTransform></path></g></g></svg> </span></div></div></div></div><div class=clearfix></div></div></div></div><div class=headermobile_nav360></div><div id=bread-crumb-container></div></header><div class=main_content_block id=doc_main_content><div><div class="container docs-main"><div class=docs-main-content><div class=left_sidebar data-nosnippet><div class=left-sidebar-header>Contents <span>x</span></div><div class=left_sidebar_main><div id=doc_left_sidebar class=left_sidebar_nav><div class=left_sidebar_nav_menu id=left_sidebar_nav_menu dir=auto><ul id=categories class=leftsidebarnav><li class=article-title-container><a href=what-is-limacharlie> <span class=article-title> Getting Started </span> </a></li><li class=article-title-container><a href=installation-keys> <span class=article-title> Sensors </span> </a></li><li class=article-title-container><a href=event-schemas> <span class=article-title> Events </span> </a></li><li class=article-title-container><a href=query-console-ui> <span class=article-title> Query Console </span> </a></li><li class=article-title-container><a href=replay> <span class=article-title> Detection and Response </span> </a></li><li class=article-title-container><a href=limacharlie-sdk> <span class=article-title> Platform Management </span> </a></li><li class=article-title-container><a href=output-allowlisting> <span class=article-title> Outputs </span> </a></li><li class=article-title-container><a href=developer-grant-program> <span class=article-title> Add-Ons </span> </a></li><li class=article-title-container><a href=reporting> <span class=article-title> Tutorials </span> </a></li><li class=article-title-container><a href=faq-general> <span class=article-title> FAQ </span> </a></li><li class=article-title-container><a href=""> <span class=article-title> Release Notes </span> </a></li><li class=article-title-container><a href=mcp-server> <span class=article-title> Connecting </span> </a></li></ul></div><div class=watermark_logo style=display:block!important;visibility:visible!important;opacity:1!important><a href="https://document360.com/powered-by-document360/?utm_source=docs&amp;utm_medium=footer&amp;utm_campaign=poweredbylogo" target=_blank style=display:block!important;visibility:visible!important;opacity:1!important> <span>Powered by</span><img style=display:inline!important;visibility:visible!important src=https://cdn.document360.io/static/images/document360-logo.svg alt=Document360> </a></div></div></div></div><div class=content_block id=doc_content_block><div id=loadingArticle style=display:none><div class=content_container><div class="content_container_text_sec medium-layout"><div class="content_container_text_sec_in article-content-loading"><div class=content_block_head><div class=article-title dir=auto><span></span> <span></span></div><hr></div><div class=content_block_text><div class=article-content><div class=text><span></span> <span></span> <span></span> <span></span></div><div class=text-img><div class=image></div><div class=img-text><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div></div><div class=text-img><div class=img-text><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div><div class=image></div></div><div class=text><span></span> <span></span> <span></span> <span></span></div></div></div></div></div></div></div><div id=partialViewContainer><div class=stickytop><div class=sticky-details><div class=article-top-head><div class=article-title>Writing and Testing Rules</div><div class=artile_info><ul><li><i class="fal fa-calendar-alt" aria-hidden=true></i><span>02 Apr 2025</span></li><li><i class="fal fa-clock" aria-hidden=true></i> <span> 12 Minutes to read </span></li></ul></div></div><div class=share-details><p>Share this <i class="fal fa-hand-point-right"></i></p><div class=share-buttons><div id=shareIconsTop></div></div></div></div><div class=progress-container><div class=progress-bar id=progressBar></div></div></div><div class=content-header><div class=container><div class=article-action-items><ul><li><div class="print_page action-item" id=print_PDF><i class="fal fa-print"></i> <span>Print</span></div></li><li><div class="share_content action-item" id=showShareIconsMobile><i class="fal fa-share-square"></i> <span>Share</span></div><div class=social_share id=shareIconsContainerMobile><div id=shareIconsMobile></div></div></li><li><div class=action-item id=darkThemeMobile><i class="fal fa-moon"></i> <span>Dark</span></div><div class=action-item id=lightThemeMobile><i class="fal fa-sun"></i> <span>Light</span></div></li></ul></div><div class=left-sidebar-header-show><i class="fal fa-list"></i><span>Contents</span></div></div></div><div id=doc_content_block><div class=content_container><div class="content_container_text_sec medium-layout"><div class=content_container_text_sec_in><div id=smartBarContainer3></div><div class=content_block_head><div class=content_block_article_head dir=auto><h1>Writing and Testing Rules</h1></div><div class=article-head-sec><div class=article-info><ul><li><i class="fal fa-calendar-alt" aria-hidden=true></i><span>Updated on 02 Apr 2025</span></li><li><i class="fal fa-clock" aria-hidden=true></i> <span> 12 Minutes to read </span></li></ul></div><div class=article-action-items><ul><li><div class="print_page action-item" id=print_PDF_1><i class="fal fa-print"></i> <span>Print</span></div></li><li><div class="share_content action-item" id=showShareIcons><i class="fal fa-share-square"></i> <span>Share</span></div><div class=social_share id=shareIconsContainer><div id=shareIcons></div></div></li><li><div class=action-item id=darkTheme><i class="fal fa-moon"></i> <span>Dark</span></div><div class=action-item id=lightTheme><i class="fal fa-sun"></i> <span>Light</span></div></li></ul></div></div><hr></div><div id=ai-article-summary-callout class=ai-article-summary-callout><div class=summary-content id=summary-content><div class=aisummary-title>Article summary</div><span class=close id=close-ai-article-summary><i class="fal fa-times-circle"></i></span><div class=aisummary-content id=aisummary-content><p></p></div></div><div class=summary-feedback><div class=feedback>Did you find this summary helpful? <button class="btn thumbs-btn" id=thumbs-up> <i class="fal fa-thumbs-up"></i> </button> <button class="btn thumbs-btn" id=thumbs-up-dis disabled> <i class="fas fa-thumbs-up like"></i> </button> <button class="btn thumbs-btn" id=thumbs-down> <i class="fal fa-thumbs-down"></i> </button> <button class="btn thumbs-btn" id=thumbs-down-dis disabled> <i class="fas fa-thumbs-down dislike"></i> </button></div><div class=comment-box id=comment-box><input placeholder="Suggestions for improvements (Optional)" placeholder="Hey, I am Eddy. How can I help you?" class=optional-comments autocomplete=off> <button class="btn send-btn" id=send-btn> <i class="fas fa-paper-plane send"></i> </button></div><div class=feedback-sent>Thank you for your feedback!</div></div></div><div class=content_block_text dir=auto><p data-block-id=f428165a-59fe-44ab-9e5f-cdad7ea6eb97>Detection &amp; Response (<span contenteditable=false translate=no data-glossary=D&amp;R data-glossary-name=D&amp;R id=blockglossary class="fr-deletable popover__title"></span>) Rules are similar to Google Cloud Functions or <span contenteditable=false translate=no data-glossary=AWS data-glossary-name=AWS id=blockglossary class="fr-deletable popover__title" data-glossaryid=6add7987-d9df-47b9-a809-3941d4d6a40a>AWS</span> Lambda.<br type=inline>They allow you to push D&amp;R rules to the LimaCharlie cloud where the rules will be applied<br type=inline>in real-time to data coming from the sensors.</p><p data-block-id=6f125763-f3c6-44c8-819d-6790cd511c12>D&amp;R rules can also be applied to <a href=/v2/docs/artifacts>Artifact Collection</a>, but for now we will focus<br type=inline>on the simple case where it is applied to <span contenteditable=false translate=no data-glossary=Sensor data-glossary-name=Sensor id=blockglossary class="fr-deletable popover__title" data-glossaryid=24cab808-0597-4472-923a-25f522a9d9fa>Sensor</span> events.</p><p data-block-id=dbfe24f4-4edd-44a9-b7ef-8c5c8a2e9f31>For a full list of all rule operators and detailed documentation see the <a href=/v2/docs/detection-and-response>Detection and Response</a> section.</p><h3 data-block-id=7cf68dc4-3d2f-498f-8e37-327993cbb398>Life of a Rule</h3><p data-block-id=dbfe012e-1f6d-41ee-b025-7aeda1a27487>D&amp;R rules are generally applied on a per-event basis. When the rule is applied, the "detection"<br type=inline>component of the rule is processed to determine if it matches. If there is a match, the "response"<br type=inline>component is applied.</p><p data-block-id=2be7a47f-f046-46be-8e1d-f3967cda4578>The detection is processed one step at a time, starting at the root of the detection. If the<br type=inline>root matches, the rule is considered to be matching.</p><p data-block-id=0621a2aa-83d3-4b8c-8199-0743141b458c>The detection component is composed of "nodes", where each node has an operator describing the<br type=inline>logical evaluation. Most operators are simple, like <code>is</code>, <code>starts with</code> etc. These simple nodes<br type=inline>can be combined with Boolean (true/false) logic using the <code>and</code> and <code>or</code> operators, which<br type=inline>themselves reference a series of nodes. The <code>and</code> node matches if all the sub-nodes match, while<br type=inline>the <code>or</code> node matches if any one of the sub-nodes matches.</p><p data-block-id=c849c01e-d2a4-4777-aa52-031c1f52bef4>When evaluating an <code>or</code>, as soon as the first matching sub-node is found, the rest of the sub-nodes<br type=inline>are skipped since they will have no impact on the final matching state of the "or". Similarly, failure of a sub-node in an "and" node will immediately terminate its evaluation.</p><p data-block-id=d27696a8-8eb9-4064-aa62-bfcac094f4bf>If the "detection" component is matched, then the "response" evaluation begins.</p><p data-block-id=86dced2e-e159-4c3a-b8d5-3d24c99b8d78>The "response" component is a list of actions that should be taken. When an action refers to a<br type=inline>sensor, that sensor is assumed to be the sensor the event being evaluated is coming from.</p><p data-block-id=b0d0f62a-62fe-4bad-95ba-81178cc65cf8>The best general strategy for D&amp;R rules is to put the parts of the rule most likely<br type=inline>to eliminate the event at the beginning of the rule, so that LC may move on to the next event<br type=inline>as quickly as possible.</p><h2 data-block-id=fd6e7f5f-ae0e-4a09-a3e4-97032175d97f>Introduction</h2><h3 data-block-id=26599bab-43de-4342-b0e4-4294407d4809>Goal</h3><p data-block-id=41f1ea68-73e1-43e4-aef7-20182e3bd016>The goal of is code lab will be to create a D&amp;R rule to detect the MITRE ATT&amp;CK framework<br type=inline><a href="https://attack.mitre.org/techniques/T1196/">Control Panel Items</a> execution.</p><h3 data-block-id=b3bebb29-afe1-42fe-9db6-47685b0eb750>Services Used</h3><p data-block-id=fa68b412-9b26-4997-89e0-fbd70042c7a0>This code lab will use the Replay service to validate and test the rule prior to pushing it to production.</p><h2 data-block-id=999c1af3-c2cd-4a46-868d-e26bb3fdc99c>Setup and Requirements</h2><p data-block-id=e5e1bad1-da4f-41ee-957d-2a9d06238e8b>This code lab assumes you have access to a Linux host (MacOS terminal with <code>brew</code>). This<br type=inline>code lab also assumes you have "owner" access to an LC <span contenteditable=false translate=no data-glossary=Organization data-glossary-name=Organization id=blockglossary class="fr-deletable popover__title" data-glossaryid=2d3fab7b-287b-46cc-9d46-c300708e4940>Organization</span>. If you don't have<br type=inline>one already, create one, this code lab is compatible with the free tier that comes with<br type=inline>all organizations.</p><h3 data-block-id=d4c38195-2d2b-496d-99d7-05b4f9316692>Install <span contenteditable=false translate=no data-glossary=CLI data-glossary-name=CLI id=blockglossary class="fr-deletable popover__title" data-glossaryid=068efcf9-0af4-4063-9f11-b2982e4a2e50>CLI</span></h3><p data-block-id=8ae48ee2-9335-4d40-9e52-658349d8a617>Interacting with LC can always be done via the <a href=https://app.limacharlie.io>web app</a> but<br type=inline>day to day operations and automation can be done via the Command Line Interface (CLI). This<br type=inline>will make following this code lab easier.</p><p data-block-id=0d27948f-13e7-4b98-8af8-f68dfb53a54e>Install the CLI: <code>pip install limacharlie --user</code>. If you don't have <code>pip</code> installed, install<br type=inline>it, the exact instructions will depend on your Linux distribution.</p><h3 data-block-id=268fa6fa-29f5-4d4b-b487-649041786c3c>Create REST API Key</h3><p data-block-id=fbeeb99c-e77f-4f7e-9d3a-6cce609edd84>We need to create an API key we can use in the CLI to authenticate with LC. To do so, go<br type=inline>to the REST API section of the web app.</p><ol data-block-id=f452b0cb-c92f-4b87-bfa6-41f519e6d9a5 start=1><li data-block-id=1a97a4b1-901c-48b1-a7ae-603319b076d7><p data-block-id=e8dab6c8-930a-4cb4-8b02-479747de530f>In the REST API section, click the "+" button in the top right of the page.</p></li><li data-block-id=a935cf11-d1b9-4fd0-bfa3-ddfdc9bd6f46><p data-block-id=32aaf1dc-9d00-4827-b5e2-f64abf123f2e>Give your key a name.</p></li><li data-block-id=b902c46f-b9ad-406a-9826-1f8f6e323e98><p data-block-id=97515595-d108-4e88-af17-0cf0672e37b8>For simplicity, click the "Select All" button to enable all permissions. Obviously this would not be a recommended in a production environment,</p></li><li data-block-id=cce37bdb-ffc0-44b0-b22e-9d75c380116c><p data-block-id=3febd1e5-1fd1-4467-ad0b-67b1bcf5a3c7>Click the copy-to-clipboard button for the new key and take note of it (pasting it in a temporary text note for example).</p></li><li data-block-id=7052c8a3-9b94-4054-9050-1e3baa6ba95f><p data-block-id=87962a8f-7027-4ad5-8922-503825e12c0d>Back on the REST API page, copy the "<span contenteditable=false translate=no data-glossary="Organization ID" data-glossary-name="Organization ID" id=blockglossary class="fr-deletable popover__title" data-glossaryid=06b9ce44-fcb4-457e-a58b-b850211e9a7b>Organization ID</span>" at the top of the page and keep note of it like the API key in the previous step.</p></li></ol><p data-block-id=6dee5c15-a9f4-4eb5-b6a2-fe26b729c207>The Organization ID (<span contenteditable=false translate=no data-glossary=OID data-glossary-name=OID id=blockglossary class="fr-deletable popover__title" data-glossaryid=b3692d99-4950-4bdf-b68e-503c62a9cf14>OID</span>) identifies uniquely your organization while the API key grants specific permissions to this organization.</p><h3 data-block-id=181276fd-ff30-4c0e-9cf7-695aeffddeac>Login to the CLI</h3><p data-block-id=07571452-621a-4b85-ba93-c5b92673b94e>Back in your terminal, log in with your credentials: <code>limacharlie login</code>.</p><ol data-block-id=42830464-ee5d-4c85-a211-f79f0d88b15a start=1><li data-block-id=3dd694b0-1e5e-4f4d-8bff-a08fb87dda19><p data-block-id=5e547f59-5850-413a-90cb-3957b4bfe366>When asked for the Organization ID, paste your OID from the previous step.</p></li><li data-block-id=3bb598ad-b7fd-46ed-8dc3-3a5772e02c89><p data-block-id=3bd4d04a-3dc3-4ed6-8236-7512866c9b21>When asked for a name for this access, you can leave it blank to set the default credentials.</p></li><li data-block-id=fa33a12d-420d-4264-9101-389b644bd8b6><p data-block-id=30761841-1e87-4780-b3f2-e62a85668d9a>When asked for the secret API key, enter the key you got from the previous step.</p></li></ol><p data-block-id=f324a9ac-192c-46b3-8112-0978a6e81d6b>You're done! If you issue a <code>limacharlie dr list</code> you should not get any errors.</p><h2 data-block-id=1e3a3600-0a3a-4114-8aac-164771052118>Draft Rule</h2><p data-block-id=abcc3a71-be67-471f-bfce-e90b5bef28e9>To draft our rule, open your preferred text editor and save the rule to a file, we'll call it <code>T1196.rule</code>.<br type=inline>The format of a rule is <a href=https://en.wikipedia.org/wiki/YAML>YAML</a>, if you are unfamiliar with it, there is benefit to spending a few minutes getting familiar. It won't take long as it is not overly complex.</p><p data-block-id=5712c0cb-f063-4796-99a4-f6888e84d16f>For our rules based on the <a href="https://attack.mitre.org/techniques/T1196/">T1196</a> technique, we need<br type=inline>to apply the following constraints:</p><ol data-block-id=8e3e61bc-b5e6-47c9-8a4a-c3cc52369f48 start=1><li data-block-id=d0e04ba0-bf41-462e-85a1-8ea2f02bd693><p data-block-id=4b8c8392-e50c-41d9-967d-55cb3c34a897>It only applies to Windows.</p></li><li data-block-id=e68f7c3d-4916-42d8-86f6-4f9f0f1ce5ef><p data-block-id=a3cf2a1a-98bb-45c3-8933-4f8d114d6c19>The event is a module (DLL for example on Windows) loading.</p></li><li data-block-id=ed494f12-ce18-49b5-9a87-1bd9a1bd0949><p data-block-id=b2d57eb2-b390-46a2-9e06-89f3145a2888>The module loading ends with <code>.cpl</code> (control panel extension).</p></li><li data-block-id=d3f4c21e-3aa1-4f15-921c-adc5871efdb3><p data-block-id=7faae35d-a948-466a-976d-c4450de84718>The module is loading from outside of the <code>C:\windows\</code> directory.</p></li></ol><p data-block-id=5b8f6d78-db90-4bac-a69a-c8caf5b7324f>LC supports a lot of different event types, this means that the first thing we should strive to<br type=inline>do to try to make the rule fail as quickly as possible is to filter all events we don't care about.</p><p data-block-id=82287954-eb40-4389-86d5-794f2c0153e3>In this case, we only care about <a href=/v2/docs/reference-edr-events#codeidentity target=_blank translate=no>CODE_IDENTITY</a> events. We also know that<br type=inline>our rule will use more than one criteria, and those criteria will be AND-ed together because we only<br type=inline>want to match when they all match.</p><pre data-block-id=9d31255c-f3d6-4280-93cc-f8675d5cdd2a language=yaml class=language-yaml><code class=language-yaml spellcheck=false>op: and
event: CODE_IDENTITY
rules:
 &nbsp;- 
</code></pre><p data-block-id=784fbb1e-edf2-41f8-981d-f88a61cd471c>The above sets up the criteria #2 preceding it, with the AND-ing that will follow. Since the AND is at the<br type=inline>top of our rule, and it has an <code>event:</code> clause, it will ensure that any event processed by this rule<br type=inline>but is NOT a <code>CODE_IDENTITY</code> event will be skipped over right away.</p><p data-block-id=4718a7d5-b69a-4409-a84a-3552bdadd435>Next, we should look at the other criteria, and add them to the <code>rules:</code> list, which are all the sub-nodes<br type=inline>that will be AND-ed together.</p><p data-block-id=642a1776-39ee-41dd-a5ff-2c6bf2eb3a17>Criteria #1 was to limit to Windows, that's easy:</p><pre data-block-id=caefb7c6-4c99-4106-b2bc-84586c23e44a language=yaml class=language-yaml><code class=language-yaml spellcheck=false>op: and
event: CODE_IDENTITY
rules:
 &nbsp;- op: is windows
 &nbsp;- 
</code></pre><p data-block-id=4da1739b-6d0b-4fa5-88b0-014462e1a3bf>Next up is criteria #3 and #4. Both of those can be determined using the <code>FILE_PATH</code> component of the<br type=inline><code>CODE_IDENTITY</code> event. If you are unure what those events look like, the best way to get a positive confirmation<br type=inline>of the structure is simply to open the Historic View, start a new process on that specific host and look for<br type=inline>the relevant event. If we were to do this on a Windows host, we'd get an example like this one:</p><pre data-block-id=7167724c-d07a-445a-a177-31fb1fa97d1e language=json class=language-json><code class=language-json spellcheck=false>{
 &nbsp; &nbsp;"routing": {
 &nbsp; &nbsp; &nbsp; &nbsp;"parent": "...",
 &nbsp; &nbsp; &nbsp; &nbsp;"this": "...",
 &nbsp; &nbsp; &nbsp; &nbsp;"hostname": "WIN-...",
 &nbsp; &nbsp; &nbsp; &nbsp;"event_type": "CODE_IDENTITY",
 &nbsp; &nbsp; &nbsp; &nbsp;"event_time": 1567438408423,
 &nbsp; &nbsp; &nbsp; &nbsp;"ext_ip": "XXX.176.XX.148",
 &nbsp; &nbsp; &nbsp; &nbsp;"event_id": "11111111-1111-1111-1111-111111111111",
 &nbsp; &nbsp; &nbsp; &nbsp;"oid": "11111111-1111-1111-1111-111111111111",
 &nbsp; &nbsp; &nbsp; &nbsp;"plat": 268435456,
 &nbsp; &nbsp; &nbsp; &nbsp;"iid": "11111111-1111-1111-1111-111111111111",
 &nbsp; &nbsp; &nbsp; &nbsp;"sid": "11111111-1111-1111-1111-111111111111",
 &nbsp; &nbsp; &nbsp; &nbsp;"int_ip": "172.XX.223.XXX",
 &nbsp; &nbsp; &nbsp; &nbsp;"arch": 2,
 &nbsp; &nbsp; &nbsp; &nbsp;"tags": [
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"..."
 &nbsp; &nbsp; &nbsp; &nbsp;],
 &nbsp; &nbsp; &nbsp; &nbsp;"moduleid": 2
 &nbsp; &nbsp;},
 &nbsp; &nbsp;"ts": "2019-09-02 15:33:28",
 &nbsp; &nbsp;"event": {
 &nbsp; &nbsp; &nbsp; &nbsp;"HASH_MD5": "7812c2c0a46d1f0a1cf8f2b23cd67341",
 &nbsp; &nbsp; &nbsp; &nbsp;"HASH": "d1d59eefe1aeea20d25a848c2c4ee4ffa93becaa3089745253f9131aedc48515",
 &nbsp; &nbsp; &nbsp; &nbsp;"ERROR": 0,
 &nbsp; &nbsp; &nbsp; &nbsp;"FILE_INFO": "10.0.17134.1",
 &nbsp; &nbsp; &nbsp; &nbsp;"HASH_SHA1": "000067ac70f0e38f46ce7f93923c6f5f06ecef7b",
 &nbsp; &nbsp; &nbsp; &nbsp;"SIGNATURE": {
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"FILE_CERT_IS_VERIFIED_LOCAL": 1,
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CERT_SUBJECT": "C=US, S=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft Windows",
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"FILE_PATH": "C:\\Windows\\System32\\setupcln.dll",
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"FILE_IS_SIGNED": 1,
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"CERT_ISSUER": "C=US, S=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft Windows Production PCA 2011"
 &nbsp; &nbsp; &nbsp; &nbsp;},
 &nbsp; &nbsp; &nbsp; &nbsp;"FILE_PATH": "C:\\Windows\\System32\\setupcln.dll"
 &nbsp; &nbsp;}
}
</code></pre><p data-block-id=2b6741f6-bc2f-4032-a2e1-1515822a7744>This means what we want is to apply rules to the <code>event/FILE_PATH</code>. First part, #3 is easy, we just want<br type=inline>to test for the <code>event/FILE_PATH</code> ends in <code>.cpl</code>, we can do this using the <code>ends with</code> operator.</p><p data-block-id=8ae937f3-98e6-49a7-951c-7822e8609261>Most operators will use a <code>path</code> and a <code>value</code>. General convention is the <code>path</code> describes<br type=inline>how to get to a value we want to compare within the event. So <code>event/FILE_PATH</code> says "starting in the <code>event</code><br type=inline>then get the <code>FILE_PATH</code>. The <code>value</code> generally represents a value we want to compare to the element found<br type=inline>in the <code>path</code>. How it is compared depends on the operator.</p><pre data-block-id=3f64dd83-c81c-45c1-8e20-8642e40d8f14 language=yaml class=language-yaml><code class=language-yaml spellcheck=false>op: and
event: CODE_IDENTITY
rules:
 &nbsp;- op: is windows
 &nbsp;- op: ends with
 &nbsp; &nbsp;path: event/FILE_PATH
 &nbsp; &nbsp;value: .cpl
</code></pre><p data-block-id=9d738978-9d28-4f4c-92c8-f920a14da6ef>That was easy, but we're missing a critical component! By default, D&amp;R rules operate in a case sensitive mode.<br type=inline>This means that the above node we added will match <code>.cpl</code> but will NOT match <code>.cPl</code>. To fix this, we just add<br type=inline>the <code>case sensitive: false</code> statement.</p><pre data-block-id=58d3c02c-325f-4304-91bb-4b7f6795eaf1 language=yaml class=language-yaml><code class=language-yaml spellcheck=false>op: and
event: CODE_IDENTITY
rules:
 &nbsp;- op: is windows
 &nbsp;- op: ends with
 &nbsp; &nbsp;path: event/FILE_PATH
 &nbsp; &nbsp;value: .cpl
 &nbsp; &nbsp;case sensitive: false
 &nbsp;- 
</code></pre><p data-block-id=09a3e190-257f-4381-a675-b277a4567293>Finally, we want to make sure the <code>event/FILE_PATH</code> is NOT in the <code>windows</code> directory. To do this, we will use<br type=inline>a regular expression with a <code>matches</code> operator. But in this case, we want to EXCLUDE the paths that include<br type=inline>the <code>windows</code> directory, so we want to "invert" the match. We can do this with the <code>not: true</code> statement.</p><pre data-block-id=cf67c57b-ed8b-4237-b2d8-c4f02efa0d84 language=yaml class=language-yaml><code class=language-yaml spellcheck=false>op: and
event: CODE_IDENTITY
rules:
 &nbsp;- op: is windows
 &nbsp;- op: ends with
 &nbsp; &nbsp;path: event/FILE_PATH
 &nbsp; &nbsp;value: .cpl
 &nbsp; &nbsp;case sensitive: false
 &nbsp;- op: matches
 &nbsp; &nbsp;path: event/FILE_PATH
 &nbsp; &nbsp;re: ^.\:\\windows\\
 &nbsp; &nbsp;case sensitive: false
 &nbsp; &nbsp;not: true
</code></pre><p data-block-id=a21ed725-1898-4223-82c4-03f73a044b24>Here we go, we're done drafting our first rule.</p><h2 data-block-id=de049eb8-6cb5-4414-b286-ef965f446aa8>Validate Rule</h2><p data-block-id=173fc730-196e-4421-9778-f968639cbefd>What we want to do now is validate the rule. If the rule validates, it doesn't mean it's correct, it<br type=inline>just means that the structure is correct, the operators we use are known, etc. It's the first pass at<br type=inline>detecting possible formatting issues or typos.</p><p data-block-id=13a0c96f-1939-42ab-8f02-a366ed4c230b>To validate, we will simply leverage the Replay service. This service can be used to test rules or replay<br type=inline>historical events against a rule. In this case however, we just want to start by validating.</p><p data-block-id=3264c3c0-357d-48de-8460-b93211b9a36f>Up until now we focused on the "detection" part of the rule. But a full rule also contains a "response"<br type=inline>component. So before we proceed, we'll add this structure. For a response, we will use a<br type=inline>simple <code>action: report</code>. The <code>report</code> creates a "detection" (alert).</p><pre data-block-id=cdbab32f-bcb6-4c21-be23-5f51abd2ae77 language=yaml class=language-yaml><code class=language-yaml spellcheck=false>detect:
 &nbsp;op: and
 &nbsp;event: CODE_IDENTITY
 &nbsp;rules:
 &nbsp; &nbsp;- op: is windows
 &nbsp; &nbsp;- op: ends with
 &nbsp; &nbsp; &nbsp;path: event/FILE_PATH
 &nbsp; &nbsp; &nbsp;value: .cpl
 &nbsp; &nbsp; &nbsp;case sensitive: false
 &nbsp; &nbsp;- op: matches
 &nbsp; &nbsp; &nbsp;path: event/FILE_PATH
 &nbsp; &nbsp; &nbsp;re: ^.\:\\windows\\
 &nbsp; &nbsp; &nbsp;case sensitive: false
 &nbsp; &nbsp; &nbsp;not: true
respond:
 &nbsp;- action: report
 &nbsp; &nbsp;name: T1196
</code></pre><p data-block-id=33d414b5-8320-4ea3-af7e-d8f531f87816>Now validate: <code>limacharlie replay --validate --rule-content T1196.rule</code></p><p data-block-id=2e7d2707-eb77-406b-bad9-de545544303c>After a few seconds, you should see a response with <code>success: true</code> if the rule<br type=inline>validates properly.</p><h2 data-block-id=65108047-5b5a-4c43-a2b2-922a49eb9422>Test rule</h2><h3 data-block-id=8a9f8eed-a99f-46f6-9cf1-55277cbab0f8>Test Plan</h3><p data-block-id=81fb2365-b30f-4a03-897e-b92d299d92b5>Now that we know our rule is generally sound, we need to test it against some events.</p><p data-block-id=51fa661b-85bd-4916-a3b4-c82947e4336c>Our test plan will take the following approach:</p><ol data-block-id=093e719e-8da1-4dd6-93c5-0b571d6b8a7c start=1><li data-block-id=17973ca1-5588-4c9c-8e17-0a839828dad5><p data-block-id=e37e3d19-d434-42fa-b4d0-86a5cbd20000>Test a positive (a <code>.cpl</code> loading outside of <code>windows</code>).</p></li><li data-block-id=c03a8393-84ce-4c4e-afc8-1779fb580a7b><p data-block-id=35507b29-45d7-436e-98b5-f6cc2b919a17>Test a negative for the major criteria:</p><ol data-block-id=236ac850-dd70-47d1-8b82-abdf47c115bf start=1><li data-block-id=7ac70ff2-762d-4902-b629-8782b316aa02><p data-block-id=177eaaf6-884c-42f2-b2bc-4f163b05d227>Test a non-<code>.cpl</code> loading outside of <code>windows</code> does not match.</p></li><li data-block-id=35f198e6-bec3-41af-b67d-622ab0d47da2><p data-block-id=f6b09493-cef8-4924-b7f8-2932898340a2>Test a <code>.cpl</code> loading within <code>windows</code> does not match.</p></li></ol></li><li data-block-id=8f45e63f-75a5-4762-8d51-7f9c5ab29d6a><p data-block-id=d033db0d-27bc-4f08-b62a-cd9c624ae7c0>Test on historical data.</p></li></ol><p data-block-id=14786a1c-2e57-4044-9e2d-7e1f9db7a0ba>With this plan, #1 and #2 lend themselves well to <a href=https://en.wikipedia.org/wiki/Unit_testing target=_blank translate=no>unit tests</a><br type=inline>while #3 can be done more holistically by using Replay to run historical events<br type=inline>through the rule and evaluate if there are any <a href=https://en.wikipedia.org/wiki/False_positives_and_false_negatives>false positives</a>.</p><p data-block-id=3b17c22f-019f-4d89-94bb-43c4e4972325>This may be excessive for you, or for certain rules which are very simple, we leave that<br type=inline>evaluation to you. For the sake of this code lab, we will do a light version to demonstrate<br type=inline>how to do tests.</p><h3 data-block-id=58290ea8-2582-4f4e-ab2c-2bb7e97e4c0d>Testing a Single Event</h3><p data-block-id=5b9b9786-4ea0-45cf-bc15-a9364ff1323e>To test #1 and #2, let's just create some synthetic events. It's always better to use<br type=inline>real-world samples, but we'll leave that up to you.</p><p data-block-id=636d6a01-ce48-4e20-b5ce-d3d7d886c00a>Take the event sample we had in the "Draft Rule" section and copy it to two new files<br type=inline>we will name <code>positive.json</code>, <code>negative-1.json</code> and <code>negative-2.json</code>.</p><p data-block-id=af9ee890-d2b0-4b5f-87da-ada5b82505f8>Modify the <code>positive.json</code> file by renaming the <code>FILE_PATH</code> at the bottom from<br type=inline><code>"C:\\Windows\\System32\\setupcln.dll"</code> to <code>"C:\\temp\\System32\\setupcln.cpl"</code> so that<br type=inline>the event now describes a <code>.cpl</code> loading in the <code>temp</code> directory, which we should detect.</p><p data-block-id=042fb1cd-1d16-462b-89e1-acf45dd3731a>Then modify the <code>negative-1.json</code> file by changing the same <code>.dll</code> to <code>.cpl</code>. This should NOT<br type=inline>match because the path is still in the <code>windows</code> directory.</p><p data-block-id=cdcbd443-e1dd-4a26-83cd-cda3d9d270bc>Then modify the <code>negative-2.json</code> file by changing the <code>windows</code> directory to <code>temp</code>. This<br type=inline>should still NOT match because it's not a <code>.cpl</code>.</p><p data-block-id=ad40b1bb-a79f-43f8-bc06-e7e567e34089>Now we can run our 3 samples against the rule using Replay,</p><p data-block-id=f6db2597-8ea8-4f7f-858f-2fdc73e9da96><code>limacharlie replay --rule-content T1196.rule --events positive.json</code> should output a result<br type=inline>indicating the event matched (by actioning the <code>report</code>) like:</p><pre data-block-id=fe9ee5e0-c38c-4c08-b1e8-a819852d7bbf language=json class=language-json><code class=language-json spellcheck=false>{
 &nbsp;"num_evals": 4,
 &nbsp;"eval_time": 0.00020599365234375,
 &nbsp;"num_events": 1,
 &nbsp;"responses": [
 &nbsp; &nbsp;{
 &nbsp; &nbsp; &nbsp;"report": {
 &nbsp; &nbsp; &nbsp; &nbsp;"source": "11111111-1111-1111-1111-111111111111.11111111-1111-1111-1111-111111111111.11111111-1111-1111-1111-111111111111.10000000.2",
 &nbsp; &nbsp; &nbsp; &nbsp;"routing": {
...
</code></pre><p data-block-id=5be9eb8a-0078-4273-b322-b77f680d9133><code>limacharlie replay --rule-content T1196.rule --events negative-1.json</code> should output a result<br type=inline>indicating the event did NOT match like:</p><pre data-block-id=294e3186-20da-495f-91c3-a0b5b2060cd0 language=json class=language-json><code class=language-json spellcheck=false>{
 &nbsp;"num_evals": 4,
 &nbsp;"eval_time": 0.00011777877807617188,
 &nbsp;"num_events": 1,
 &nbsp;"responses": [],
 &nbsp;"errors": []
}
</code></pre><p data-block-id=22f50fd0-c521-405f-9bc1-7af7315182fa><code>limacharlie replay --rule-content T1196.rule --events negative-2.json</code> be the same as <code>negative-1.json</code>.</p><h3 data-block-id=794c8707-2969-4128-80eb-efc90c439353>Testing Historical Data</h3><p data-block-id=a9cb39d1-abee-43db-ae9e-4de5c1c84dfb>The final test is to run the rule against historical data. If you are not using an<br type=inline>organization on the free tier, note that the Replay API is billed on usage. In the<br type=inline>following step we will run against all historical data from the organization, so if<br type=inline>your organization is not on the free tier and it is large, there may be non-trivial<br type=inline>costs associated.</p><p data-block-id=374e66bd-cb5f-4617-8944-ea312a3759c1>Running our rule against the last week of data is simple:</p><p data-block-id=59ab9628-2821-41f2-8849-913ddca6d349><code>limacharlie replay --rule-content T1196.rule --entire-org --last-seconds 604800</code></p><p data-block-id=f9a4de0a-7101-49a9-8fde-94817adaea74>No matches should look like that:</p><pre data-block-id=b07ad2b9-5cb5-4351-8bfc-0b93832650fd language=json class=language-json><code class=language-json spellcheck=false>{
 &nbsp;"num_evals": 67354,
 &nbsp;"eval_time": 1107.2150619029999,
 &nbsp;"num_events": 222938,
 &nbsp;"responses": [],
 &nbsp;"errors": []
}</code></pre><h3 data-block-id=2d862afa-303b-4c85-9586-c74364b3fb44>Moving to Unit Tests</h3><p data-block-id=c1fee38b-35cd-4348-9f92-0e559c8d0732>Once your rule is done and youve evaluated various events for matches, you can move these to <a href=/v2/docs/unit-tests target=_self translate=no>D&amp;R Rules Unit Tests</a> so that the tests are run during rule update.</p><h2 data-block-id=dc474348-0ad9-49bb-a241-2d9e8d6360f9>Publish Rule</h2><p data-block-id=32c16400-d1d7-4ba5-b716-ae0e9a038c35>Now is the time to push the new rule to production, the easy part.</p><p data-block-id=9bab602c-c306-4b64-9676-c6a58ca1e9ea>Simply run <code>limacharlie dr add --rule-name T1196 --rule-file T1196.rule</code><br type=inline>and confirm it is operational by running <code>limacharlie dr list</code>.</p><div class=glossary-popover-contents><div class="popover__content hidden 6add7987-d9df-47b9-a809-3941d4d6a40a"><p>Amazon Web Services</p></div><div class="popover__content hidden 24cab808-0597-4472-923a-25f522a9d9fa"><p>Similar to agents, Sensors send telemetry to the LimaCharlie platform in the form of EDR telemetry or forwarded logs. Sensors are offered as a scalable, serverless solution for securely connecting endpoints of an organization to the cloud.</p></div><div class="popover__content hidden 2d3fab7b-287b-46cc-9d46-c300708e4940"><p>In LimaCharlie, an Organization represents a tenant within the SecOps Cloud Platform, providing a self-contained environment to manage security data, configurations, and assets independently. Each Organization has its own sensors, detection rules, data sources, and outputs, offering complete control over security operations. This structure enables flexible, multi-tenant setups, ideal for managed security providers or enterprises managing multiple departments or clients.</p></div><div class="popover__content hidden 068efcf9-0af4-4063-9f11-b2982e4a2e50"><p>Command-line Interface</p></div><div class="popover__content hidden 06b9ce44-fcb4-457e-a58b-b850211e9a7b"><p>In LimaCharlie, an Organization ID is a unique identifier assigned to each tenant or customer account. It distinguishes different organizations within the platform, enabling LimaCharlie to manage resources, permissions, and data segregation securely. The Organization ID ensures that all telemetry, configurations, and operations are kept isolated and specific to each organization, allowing for multi-tenant support and clear separation between different customer environments.</p><br><br></div><div class="popover__content hidden b3692d99-4950-4bdf-b68e-503c62a9cf14"><p>In LimaCharlie, an Organization ID (OID) is a unique identifier assigned to each tenant or customer account. It distinguishes different organizations within the platform, enabling LimaCharlie to manage resources, permissions, and data segregation securely. The Organization ID ensures that all telemetry, configurations, and operations are kept isolated and specific to each organization, allowing for multi-tenant support and clear separation between different customer environments.</p></div></div><div class=mobile-tryit></div></div><div class="sperator sperator-both"><hr></div><div class=article-vote-container id=doc_review_container dir=auto><div class=txt>Was this article helpful?</div><div class=actions><button class="btn yes" id=reviewLikeButton> <i class="fal fa-thumbs-up"></i> Yes </button> <button class="btn no" id=reviewDislikeButton> <i class="fal fa-thumbs-down"></i> No </button></div></div><div class=submit-text-container id=submit-text-container style=display:none dir=auto><div class=check-submit><i class="fal fa-comment-check"></i></div><div>Thank you for your feedback! Our team will get back to you</div></div><div id=doc_feedback_collect style=display:none dir=auto><div class=txt>How can we improve this article?</div><div class=feedback_txt id=your_feedback>Your feedback</div><div id=feedback_box><div id=dislike_feedback class="first-row dislike-container"><div class=check_input><input id=needMoreInfo class=feedback-checkbox name=needMoreInfo type=checkbox value="Need more information" autocomplete=off> <label><span>Need more information</span></label></div><div class=check_input><input id=difficultToUnderstand class=feedback-checkbox name=difficultToUnderstand type=checkbox value="Difficult to understand" autocomplete=off> <label><span>Difficult to understand</span></label></div><div class=check_input><input id=irrelevantContent class=feedback-checkbox name=irrelevantContent type=checkbox value="Inaccurate or irrelevant content" autocomplete=off> <label><span>Inaccurate or irrelevant content</span></label></div><div class=check_input><input id=missingBrokenLink class=feedback-checkbox name=missingBrokenLink type=checkbox value="Missing/broken link" autocomplete=off> <label><span>Missing/broken link</span></label></div><div class=check_input><input id=others name=others class=feedback-checkbox type=checkbox value=Others autocomplete=off> <label><span>Others</span></label></div></div><div><div class=comment-txt id=comment-txt style=display:none>Comment</div><div class=comment-txt id=comment-txt-optional style=display:none>Comment (Optional)</div><textarea class=feedback_textarea id=feedback_area rows=3 maxlength=500 placeholder="Enter your comment" autocomplete=off></textarea><div class=feedback_maxlimit>Character limit : 500</div><div id=commentValidator class="validator-error-msg hidden">Please enter your comment</div><div class=email-container><div class=email-txt id=email_text_optional style=display:none>Email (Optional)</div><div class=email-txt id=email_text style=display:none>Email</div><div><input class=feedback-checkbox id=notifyMeAboutChanges name=Remember value="Notify me about change" type=checkbox autocomplete=off> <label for=notifyMeAboutChanges class="custom-control-label w-100"> Notify me about change</label><br></div></div><input class=feedback_textarea id=feedback_mail rows=3 placeholder="Enter your email" autocomplete=off><div id=emailValidator class="validator-error-msg-email hidden">Please enter a valid email</div></div></div><div class="actions actionContainer"><button type=button class="btn btn-cancel" id=reviewCancel>Cancel</button> <input type=button class="btn btn-primary btn-disabled g-recaptcha" data-sitekey=6LcsSdIiAAAAAL7OJkCzCU7INGM1iJ2THEvHXc81 data-callback=feedbackSubmit value=Send name=recaptcha id=reviewSubmit></div></div><div class="sperator sperator-top"><hr></div><div class=related-articles-container dir=auto><h6>Related articles</h6><ul><li><a href=/docs/detection-and-response-examples> Detection and Response Examples </a></li><li><a href=/docs/detection-and-response> Detection and Response </a></li><li><a href=/docs/detection-on-alternate-targets> Detection on Alternate Targets </a></li><li><a href=/docs/sigma-converter> Sigma Converter </a></li></ul></div><div class="sperator sperator-top"><hr></div><div class=whats-next-container><h6>What's Next</h6><ul><li><a href=/docs/create-a-dr-rule-using-a-threat-feed> Create a D&amp;R Rule Using a Threat Feed </a> <i class="far fa-arrow-right"></i></li></ul></div><div id=smartBarContainer4></div></div></div><div class=page-action><div class=right_sidebar_sticky id=right_sidebar><div class=article_action_links id=content_links dir=auto><p><span>Table of contents</span></p><div id=content-links><ul><ul><li id=toc><a href=#introduction> Introduction </a></li><li id=toc><a href=#setup-and-requirements> Setup and Requirements </a></li><li id=toc><a href=#draft-rule> Draft Rule </a></li><li id=toc><a href=#validate-rule> Validate Rule </a></li><li id=toc><a href=#test-rule> Test rule </a></li><li id=toc><a href=#publish-rule> Publish Rule </a></li></ul></ul></div></div><div class=tags-articles dir=auto><p>Tags</p><ul><li><a href=/docs/en/tags/detection%20and%20response data-desctag=""> detection and response </a></li><li><a href=/docs/en/tags/tutorial title=Tutorial data-desctag=Tutorial> tutorial </a></li></ul></div></div></div></div></div><div id=smartBarContainer4></div></div></div></div></div><script src=https://cdn.document360.io/static/js/doc-index.153c537bec0d6e3e9445.js.gz></script></div></div><div class=notify-toaster></div><div id=smartBarContainer2></div><div class=custom-footer></div><custom-js id=customJavaScript><script nonce=""></script></custom-js> <!-- Include AlgoliaSearch JS Client and autocomplete.js library --><script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js?t=1604893222738"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js?t=1604893222738"></script><script src="https://www.google.com/recaptcha/api.js?onload=resetFeedbackReCaptcha&amp;render=explicit" async defer></script><div id=smartBarGlobalDiv class=info-bar style=display:none><div class=info-bar-in><div id=smartBarContent class=info-bar-cont dir=auto></div></div></div><div class=back-to-top id=back-to-top><i class="fal fa-angle-up"></i></div></body></html>